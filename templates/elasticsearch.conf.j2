{# Set up VirtualHosts - servername and documentroot are required. #}
{% for vhost in apache_vhosts_elasticsearch %}
<VirtualHost *:7070>
  ServerName {{ vhost.servername }}
{% if vhost.serveradmin is defined %}
  ServerAdmin {{ vhost.serveradmin }}
{% endif %}

  ProxyPass /elasticsearch http://localhost:9200
  ProxyPassReverse /elasticsearch http://localhost:9200
  alias /kibana {{ vhost.documentroot }}

  <Location /elasticsearch>
      Order allow,deny
      Allow from all
  </Location>
  
{% if vhost.extra_parameters is defined %}
  {{ vhost.extra_parameters }}
{% endif %}  
  
  LogLevel debug
  ErrorLog /var/log/{{ apache_directory }}/elasticsearch_error.log
  CustomLog /var/log/{{ apache_directory }}/elasticsearch_access.log combined
    
</VirtualHost>

{% endfor %}
